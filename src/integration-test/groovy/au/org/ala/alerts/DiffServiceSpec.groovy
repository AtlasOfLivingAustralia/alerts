/*
 * Copyright (C) 2017 Atlas of Living Australia
 * All Rights Reserved.
 * The contents of this file are subject to the Mozilla Public
 * License Version 1.1 (the "License"); you may not use this file
 * except in compliance with the License. You may obtain a copy of
 * the License at http://www.mozilla.org/MPL/
 * Software distributed under the License is distributed on an "AS
 * IS" basis, WITHOUT WARRANTY OF ANY KIND, either express or
 * implied. See the License for the specific language governing
 * rights and limitations under the License.
 */

package au.org.ala.alerts

import grails.test.mixin.integration.Integration
import grails.gorm.transactions.*
import org.springframework.beans.factory.annotation.Autowired
import spock.lang.*

@Integration
@Rollback
class DiffServiceSpec extends Specification {
    @Autowired
    DiffService diffService

    def setup() {
    }

    def cleanup() {
    }

    void "test hasChangedJsonDiff for blogs and news query"() {
        given:
        def query = Query.findByName("Blogs and News")
        def json1 = """
                {"status":"ok","count":2,"pages":140,"category":{"id":2,"slug":"blogs-news","title":"Blogs &amp; news","description":"","parent":0,"post_count":279},"posts":[{"id":38260,"type":"post","slug":"spotlight-on-ala-users-clare-pearce","url":"https://www.ala.org.au/blogs-news/spotlight-on-ala-users-clare-pearce/","status":"publish","title":"Spotlight on ALA Users &#8211; Clare Pearce","title_plain":"Spotlight on ALA Users &#8211; Clare Pearce","content":"<p>Clare is the Community Engagement Officer with Parks and Wildlife based in Katherine. Part of her role involves working with kids in the Junior Ranger program. The program delivers hands-on activities based in environmental education for between 10-30 kids at a time, including activities such as hiking, tracking, navigation, spotlighting and birdwatching.</p><div id=\\"attachment_38264\\" style=\\"width: 310px\\" class=\\"wp-caption aligncenter\\"><img src=\\"http://www.ala.org.au/wp-content/uploads/2017/08/jul173.3-300x300.png\\" alt=\\"Egretta picata. Image by Clare Pearce - ALA Individual Sightings\\" width=\\"300\\" height=\\"300\\" class=\\"size-medium wp-image-38264\\" srcset=\\"https://www.ala.org.au/wp-content/uploads/2017/08/jul173.3-300x300.png 300w, https://www.ala.org.au/wp-content/uploads/2017/08/jul173.3-150x150.png 150w, https://www.ala.org.au/wp-content/uploads/2017/08/jul173.3.png 441w\\" sizes=\\"(max-width: 300px) 100vw, 300px\\" /><p class=\\"wp-caption-text\\">Egretta picata. Image by Clare Pearce &#8211; ALA Individual Sightings</p></div><p>Her groups don’t do any formal collecting activities, but Clare enters some of the images of things they find during their activities in and around the Nitmiluk National Park. She said that the kids are getting better at being careful with the animals they find and they’re especially keen on frogs, bugs and geckos.</p><div id=\\"attachment_38262\\" style=\\"width: 285px\\" class=\\"wp-caption aligncenter\\"><img src=\\"http://www.ala.org.au/wp-content/uploads/2017/08/jul173.1-300x300.png\\" alt=\\"Platyplectrum ornatum. Image by Clare Pearce - ALA Individual Sightings\\" width=\\"275\\" height=\\"275\\" class=\\" wp-image-38262\\" srcset=\\"https://www.ala.org.au/wp-content/uploads/2017/08/jul173.1-300x300.png 300w, https://www.ala.org.au/wp-content/uploads/2017/08/jul173.1-150x150.png 150w, https://www.ala.org.au/wp-content/uploads/2017/08/jul173.1.png 682w\\" sizes=\\"(max-width: 275px) 100vw, 275px\\" /><p class=\\"wp-caption-text\\">Platyplectrum ornatum. Image by Clare Pearce &#8211; ALA Individual Sightings</p></div><p>As well as contributing the sightings to the ALA database, she uses the species information, images and species distribution maps to assist in identifying the specimens.</p><p>Ranger Clare also presents talks to schools and community members and contributes articles to websites and newspapers. The ALA is one of the resources she uses to check facts while preparing these.</p><div id=\\"attachment_38265\\" style=\\"width: 278px\\" class=\\"wp-caption aligncenter\\"><img src=\\"http://www.ala.org.au/wp-content/uploads/2017/08/jul173.4-300x298.png\\" alt=\\"Nymphaea violacea. Image by Clare Pearce - ALA Individual Sightings\\" width=\\"268\\" height=\\"266\\" class=\\" wp-image-38265\\" srcset=\\"https://www.ala.org.au/wp-content/uploads/2017/08/jul173.4-300x298.png 300w, https://www.ala.org.au/wp-content/uploads/2017/08/jul173.4-150x150.png 150w, https://www.ala.org.au/wp-content/uploads/2017/08/jul173.4.png 485w\\" sizes=\\"(max-width: 268px) 100vw, 268px\\" /><p class=\\"wp-caption-text\\">Nymphaea violacea. Image by Clare Pearce &#8211; ALA Individual Sightings</p></div><p>She was initially reluctant to contribute to the ALA as she didn’t think her data was “good enough”. With her wealth of knowledge and photography skills, we are glad that she started adding her sightings to share with others through the ALA.</p><p>Please <a href=\\"https://www.ala.org.au/about-the-atlas/contact-us/\\">contact us</a> if you would like to share how you use the ALA.</p>","excerpt":"<p>Clare Pearce’s images in the ALA’s Recent Sightings could be part of a tourism campaign advertising the Northern Territory.</p>\\n","date":"2017-08-23 11:12:47","modified":"2017-08-23 11:12:47","categories":[{"id":147,"slug":"atlas-user-profiles","title":"Atlas user profiles","description":"","parent":0,"post_count":10},{"id":2,"slug":"blogs-news","title":"Blogs &amp; news","description":"","parent":0,"post_count":279}],"tags":[],"author":{"id":21,"slug":"superstarynhotmail-com","name":"Taryn","first_name":"Taryn","last_name":"Johnson","nickname":"superstaryn@hotmail.com","url":"","description":""},"comments":[],"attachments":[{"id":38262,"url":"http://www.ala.org.au/wp-content/uploads/2017/08/jul173.1.png","slug":"jul173-1","title":"jul17(3.1)","description":"Platyplectrum ornatum. Image by Clare Pearce - ALA Individual Sightings","caption":"Platyplectrum ornatum. Image by Clare Pearce - ALA Individual Sightings","parent":38260,"mime_type":"image/png","images":{"full":{"url":"https://www.ala.org.au/wp-content/uploads/2017/08/jul173.1.png","width":682,"height":684},"thumbnail":{"url":"https://www.ala.org.au/wp-content/uploads/2017/08/jul173.1-150x150.png","width":150,"height":150},"medium":{"url":"https://www.ala.org.au/wp-content/uploads/2017/08/jul173.1-300x300.png","width":300,"height":300},"medium_large":{"url":"https://www.ala.org.au/wp-content/uploads/2017/08/jul173.1.png","width":682,"height":684},"large":{"url":"https://www.ala.org.au/wp-content/uploads/2017/08/jul173.1.png","width":682,"height":684}}},{"id":38264,"url":"http://www.ala.org.au/wp-content/uploads/2017/08/jul173.3.png","slug":"jul173-3","title":"jul17(3.3)","description":"Egretta picata. Image by Clare Pearce - ALA Individual Sightings","caption":"Egretta picata. Image by Clare Pearce - ALA Individual Sightings","parent":38260,"mime_type":"image/png","images":{"full":{"url":"https://www.ala.org.au/wp-content/uploads/2017/08/jul173.3.png","width":441,"height":441},"thumbnail":{"url":"https://www.ala.org.au/wp-content/uploads/2017/08/jul173.3-150x150.png","width":150,"height":150},"medium":{"url":"https://www.ala.org.au/wp-content/uploads/2017/08/jul173.3-300x300.png","width":300,"height":300},"medium_large":{"url":"https://www.ala.org.au/wp-content/uploads/2017/08/jul173.3.png","width":441,"height":441},"large":{"url":"https://www.ala.org.au/wp-content/uploads/2017/08/jul173.3.png","width":441,"height":441}}},{"id":38265,"url":"http://www.ala.org.au/wp-content/uploads/2017/08/jul173.4.png","slug":"jul173-4","title":"jul17(3.4)","description":"Nymphaea violacea. Image by Clare Pearce - ALA Individual Sightings","caption":"Nymphaea violacea. Image by Clare Pearce - ALA Individual Sightings","parent":38260,"mime_type":"image/png","images":{"full":{"url":"https://www.ala.org.au/wp-content/uploads/2017/08/jul173.4.png","width":485,"height":481},"thumbnail":{"url":"https://www.ala.org.au/wp-content/uploads/2017/08/jul173.4-150x150.png","width":150,"height":150},"medium":{"url":"https://www.ala.org.au/wp-content/uploads/2017/08/jul173.4-300x298.png","width":300,"height":298},"medium_large":{"url":"https://www.ala.org.au/wp-content/uploads/2017/08/jul173.4.png","width":485,"height":481},"large":{"url":"https://www.ala.org.au/wp-content/uploads/2017/08/jul173.4.png","width":485,"height":481}}}],"comment_count":0,"comment_status":"closed","custom_fields":{}},{"id":38294,"type":"post","slug":"join-the-worlds-biggest-fish-race-around-the-world","url":"https://www.ala.org.au/blogs-news/join-the-worlds-biggest-fish-race-around-the-world/","status":"publish","title":"Join the world’s biggest fish race around the world","title_plain":"Join the world’s biggest fish race around the world","content":"<p>It’s National Science Week this week, and there’s lots of things to get involved in, including the Whale Shark Race Around the World. The Race which officially kicked off yesterday, will see schools around the country join scientists in tracking the movements of the world’s biggest fish &#8211; the Whale Shark.</p><p>ECOCEAN is Australia’s only not-for-profit research organisation dedicated to conserving the whale shark. As well as expanding our knowledge of whale shark movements and distribution in the south-eastern Indian Ocean, their research has also expanded the learning opportunities for Western Australian school students through the Whale Shark Race Around the World.</p><div id=\\"attachment_38298\\" style=\\"width: 1034px\\" class=\\"wp-caption aligncenter\\"><img width=\\"1024\\" height=\\"768\\" class=\\"size-large wp-image-38298\\" alt=\\"\\" src=\\"http://www.ala.org.au/wp-content/uploads/2017/08/Swim3_30.7.15lge-1024x768.jpg\\" srcset=\\"https://www.ala.org.au/wp-content/uploads/2017/08/Swim3_30.7.15lge-1024x768.jpg 1024w, https://www.ala.org.au/wp-content/uploads/2017/08/Swim3_30.7.15lge-300x225.jpg 300w, https://www.ala.org.au/wp-content/uploads/2017/08/Swim3_30.7.15lge-768x576.jpg 768w\\" sizes=\\"(max-width: 1024px) 100vw, 1024px\\" /><p class=\\"wp-caption-text\\">The Whale Shark Race Around the World kicked off on 14th August 2017 just in time for National Science Week. Image credit: ECOCEAN</p></div><p>&nbsp;</p><p>The Whale Shark Race Around the World started in 2015 with schools around Western Australia sponsoring satellite tags that were deployed on whale sharks at Ningaloo Reef, Western Australia. The Race is a joint ECOCEAN-Department of Education program designed to inspire students in science, technology, engineering and maths (STEM) learning. The tracks of the tagged sharks are available for anyone to see on ALA’s Zoatrack (<a href=\\"http://www.zoatrack.org/\\">www.zoatrack.org</a>) platform, so students are able to follow the movements of their sharks. Samantha Reynolds is one of the lead researchers for the project, and she said, “We bring real-world scientific research directly into the classroom and use the world’s biggest fish to get kids excited about science and marine conservation”.</p><p>For this year’s race, teachers and students will be able to use ZoaTrack visualisation and analysis tools in their lessons and will have access to the ongoing tracking of the sharks. Involvement in the race will support students and teachers to further develop their STEM capabilities, including: critical analysis and creative thinking, deepen their knowledge and understanding of the whale shark, the marine environment of Western Australia and scientific research. Teaching and learning resources developed by the Department of Education are designed to support teachers and students to engage in innovative and interactive STEM learning activities.</p><p>Tagging of whale sharks for the 2017 Race Around the World has been happening over the past few weeks, and researchers have been tagging large, mature whale sharks, hoping to gain insights into where they go to breed. “We’d like to find some clues to where whale sharks go to find love”, said Ms Reynolds, “because despite being the biggest fish in the sea, we still don’t know where they mate or give birth” she explained.</p><div id=\\"attachment_38297\\" style=\\"width: 1034px\\" class=\\"wp-caption aligncenter\\"><img width=\\"1024\\" height=\\"646\\" class=\\"size-large wp-image-38297\\" alt=\\"\\" src=\\"http://www.ala.org.au/wp-content/uploads/2017/08/SReynolds_photographs_shark_copyright_Janine_Marx-1024x646.jpg\\" srcset=\\"https://www.ala.org.au/wp-content/uploads/2017/08/SReynolds_photographs_shark_copyright_Janine_Marx-1024x646.jpg 1024w, https://www.ala.org.au/wp-content/uploads/2017/08/SReynolds_photographs_shark_copyright_Janine_Marx-300x189.jpg 300w, https://www.ala.org.au/wp-content/uploads/2017/08/SReynolds_photographs_shark_copyright_Janine_Marx-768x485.jpg 768w\\" sizes=\\"(max-width: 1024px) 100vw, 1024px\\" /><p class=\\"wp-caption-text\\">Samantha Reynolds photographing a Whale Shark. Image credit: Janine Marx.</p></div><p>&nbsp;</p><p>You can take a look at the tracks of the tagged whale sharks which is being updated daily at (<a href=\\"https://zoatrack.org/whalesharkrace\\">https://zoatrack.org/whalesharkrace</a>).</p><p><strong>About ECOCEAN (www.whaleshark.org.au)</strong></p><p>ECOCEAN is Australia’s only not-for-profit research organisation dedicated to conserving the world’s biggest fish, the whale shark. ECOCEAN scientists have been working on whale sharks at Ningaloo Reef since 1995 and have contributed to the global protection of whale sharks through reports to the IUCN Red List of Threatened Species and the United Nations Convention on International Trade in Endangered Species (CITES). ECOCEAN also promotes conservation of whale sharks and the marine environment by engaging members of the public in its pioneering “citizen science” projects. ECOCEAN was instrumental in setting up the world’s largest whale shark photo-identification library, now called the Wildbook for Whale Sharks, which encourages members of the public to get involved in whale shark research by submitting their photos online. The library currently has over 8000 individually identified whale sharks from over 50 countries around the world. And an innovative new program by ECOCEAN is engaging the next generation of scientists by involving school children in the satellite-tracking of whale sharks, connecting them to real-world scientific research and inspiring them to protect and conserve our precious marine environment and its inhabitants.</p><p>For more information about ECOCEAN or about the Whale Shark Race Around the World, please contact Samantha Reynolds at <a href=\\"mailto:samantha.reynolds1@uq.net.au\\">mailto:samantha.reynolds1@uq.net.au</a> or 0424563472. For more information about ZoaTrack please visit the website (<a href=\\"https://zoatrack.org/\\">https://zoatrack.org/</a>).</p>","excerpt":"<p>It’s National Science Week this week, and there’s lots of things to get involved in, including the Whale Shark Race Around the World. The Race which officially kicked off yesterday, will see schools around the country join scientists in tracking the movements of the world’s biggest fish &#8211; the Whale Shark.ECOCEAN is Australia’s only not-for-profit [&hellip;]</p>\\n","date":"2017-08-15 16:40:07","modified":"2017-08-15 16:43:34","categories":[{"id":2,"slug":"blogs-news","title":"Blogs &amp; news","description":"","parent":0,"post_count":279}],"tags":[],"author":{"id":31,"slug":"hannah-scottcsiro-au","name":"Hannah Scott","first_name":"Hannah","last_name":"Scott","nickname":"Hannah.Scott@csiro.au","url":"","description":""},"comments":[],"attachments":[{"id":38297,"url":"http://www.ala.org.au/wp-content/uploads/2017/08/SReynolds_photographs_shark_copyright_Janine_Marx.jpg","slug":"sreynolds_photographs_shark_copyright_janine_marx","title":"SReynolds_photographs_shark_copyright_Janine_Marx","description":"","caption":"Samantha Reynolds photographing a Whale Shark.  Image credit: Janine Marx. ","parent":38294,"mime_type":"image/jpeg","images":{"full":{"url":"https://www.ala.org.au/wp-content/uploads/2017/08/SReynolds_photographs_shark_copyright_Janine_Marx.jpg","width":3261,"height":2058},"thumbnail":{"url":"https://www.ala.org.au/wp-content/uploads/2017/08/SReynolds_photographs_shark_copyright_Janine_Marx-150x150.jpg","width":150,"height":150},"medium":{"url":"https://www.ala.org.au/wp-content/uploads/2017/08/SReynolds_photographs_shark_copyright_Janine_Marx-300x189.jpg","width":300,"height":189},"medium_large":{"url":"https://www.ala.org.au/wp-content/uploads/2017/08/SReynolds_photographs_shark_copyright_Janine_Marx-768x485.jpg","width":768,"height":485},"large":{"url":"https://www.ala.org.au/wp-content/uploads/2017/08/SReynolds_photographs_shark_copyright_Janine_Marx-1024x646.jpg","width":1024,"height":646}}},{"id":38298,"url":"http://www.ala.org.au/wp-content/uploads/2017/08/Swim3_30.7.15lge.jpg","slug":"olympus-digital-camera-3","title":"OLYMPUS DIGITAL CAMERA","description":"","caption":"The Whale Shark Race Around the World kicked off on 14th August 2017 just in time for National Science Week.  Image credit: ECOCEAN","parent":38294,"mime_type":"image/jpeg","images":{"full":{"url":"https://www.ala.org.au/wp-content/uploads/2017/08/Swim3_30.7.15lge.jpg","width":1894,"height":1421},"thumbnail":{"url":"https://www.ala.org.au/wp-content/uploads/2017/08/Swim3_30.7.15lge-150x150.jpg","width":150,"height":150},"medium":{"url":"https://www.ala.org.au/wp-content/uploads/2017/08/Swim3_30.7.15lge-300x225.jpg","width":300,"height":225},"medium_large":{"url":"https://www.ala.org.au/wp-content/uploads/2017/08/Swim3_30.7.15lge-768x576.jpg","width":768,"height":576},"large":{"url":"https://www.ala.org.au/wp-content/uploads/2017/08/Swim3_30.7.15lge-1024x768.jpg","width":1024,"height":768}}}],"comment_count":0,"comment_status":"closed","custom_fields":{}}]}
                """.stripIndent()
        def json2 = """
                {"status":"ok","count":4,"pages":70,"category":{"id":2,"slug":"blogs-news","title":"Blogs &amp; news","description":"","parent":0,"post_count":279},"posts":[{"id":38294,"type":"post","slug":"join-the-worlds-biggest-fish-race-around-the-world","url":"https://www.ala.org.au/blogs-news/join-the-worlds-biggest-fish-race-around-the-world/","status":"publish","title":"Join the world’s biggest fish race around the world","title_plain":"Join the world’s biggest fish race around the world","content":"<p>It’s National Science Week this week, and there’s lots of things to get involved in, including the Whale Shark Race Around the World. The Race which officially kicked off yesterday, will see schools around the country join scientists in tracking the movements of the world’s biggest fish &#8211; the Whale Shark.</p><p>ECOCEAN is Australia’s only not-for-profit research organisation dedicated to conserving the whale shark. As well as expanding our knowledge of whale shark movements and distribution in the south-eastern Indian Ocean, their research has also expanded the learning opportunities for Western Australian school students through the Whale Shark Race Around the World.</p><div id=\\"attachment_38298\\" style=\\"width: 1034px\\" class=\\"wp-caption aligncenter\\"><img width=\\"1024\\" height=\\"768\\" class=\\"size-large wp-image-38298\\" alt=\\"\\" src=\\"http://www.ala.org.au/wp-content/uploads/2017/08/Swim3_30.7.15lge-1024x768.jpg\\" srcset=\\"https://www.ala.org.au/wp-content/uploads/2017/08/Swim3_30.7.15lge-1024x768.jpg 1024w, https://www.ala.org.au/wp-content/uploads/2017/08/Swim3_30.7.15lge-300x225.jpg 300w, https://www.ala.org.au/wp-content/uploads/2017/08/Swim3_30.7.15lge-768x576.jpg 768w\\" sizes=\\"(max-width: 1024px) 100vw, 1024px\\" /><p class=\\"wp-caption-text\\">The Whale Shark Race Around the World kicked off on 14th August 2017 just in time for National Science Week. Image credit: ECOCEAN</p></div><p>&nbsp;</p><p>The Whale Shark Race Around the World started in 2015 with schools around Western Australia sponsoring satellite tags that were deployed on whale sharks at Ningaloo Reef, Western Australia. The Race is a joint ECOCEAN-Department of Education program designed to inspire students in science, technology, engineering and maths (STEM) learning. The tracks of the tagged sharks are available for anyone to see on ALA’s Zoatrack (<a href=\\"http://www.zoatrack.org/\\">www.zoatrack.org</a>) platform, so students are able to follow the movements of their sharks. Samantha Reynolds is one of the lead researchers for the project, and she said, “We bring real-world scientific research directly into the classroom and use the world’s biggest fish to get kids excited about science and marine conservation”.</p><p>For this year’s race, teachers and students will be able to use ZoaTrack visualisation and analysis tools in their lessons and will have access to the ongoing tracking of the sharks. Involvement in the race will support students and teachers to further develop their STEM capabilities, including: critical analysis and creative thinking, deepen their knowledge and understanding of the whale shark, the marine environment of Western Australia and scientific research. Teaching and learning resources developed by the Department of Education are designed to support teachers and students to engage in innovative and interactive STEM learning activities.</p><p>Tagging of whale sharks for the 2017 Race Around the World has been happening over the past few weeks, and researchers have been tagging large, mature whale sharks, hoping to gain insights into where they go to breed. “We’d like to find some clues to where whale sharks go to find love”, said Ms Reynolds, “because despite being the biggest fish in the sea, we still don’t know where they mate or give birth” she explained.</p><div id=\\"attachment_38297\\" style=\\"width: 1034px\\" class=\\"wp-caption aligncenter\\"><img width=\\"1024\\" height=\\"646\\" class=\\"size-large wp-image-38297\\" alt=\\"\\" src=\\"http://www.ala.org.au/wp-content/uploads/2017/08/SReynolds_photographs_shark_copyright_Janine_Marx-1024x646.jpg\\" srcset=\\"https://www.ala.org.au/wp-content/uploads/2017/08/SReynolds_photographs_shark_copyright_Janine_Marx-1024x646.jpg 1024w, https://www.ala.org.au/wp-content/uploads/2017/08/SReynolds_photographs_shark_copyright_Janine_Marx-300x189.jpg 300w, https://www.ala.org.au/wp-content/uploads/2017/08/SReynolds_photographs_shark_copyright_Janine_Marx-768x485.jpg 768w\\" sizes=\\"(max-width: 1024px) 100vw, 1024px\\" /><p class=\\"wp-caption-text\\">Samantha Reynolds photographing a Whale Shark. Image credit: Janine Marx.</p></div><p>&nbsp;</p><p>You can take a look at the tracks of the tagged whale sharks which is being updated daily at (<a href=\\"https://zoatrack.org/whalesharkrace\\">https://zoatrack.org/whalesharkrace</a>).</p><p><strong>About ECOCEAN (www.whaleshark.org.au)</strong></p><p>ECOCEAN is Australia’s only not-for-profit research organisation dedicated to conserving the world’s biggest fish, the whale shark. ECOCEAN scientists have been working on whale sharks at Ningaloo Reef since 1995 and have contributed to the global protection of whale sharks through reports to the IUCN Red List of Threatened Species and the United Nations Convention on International Trade in Endangered Species (CITES). ECOCEAN also promotes conservation of whale sharks and the marine environment by engaging members of the public in its pioneering “citizen science” projects. ECOCEAN was instrumental in setting up the world’s largest whale shark photo-identification library, now called the Wildbook for Whale Sharks, which encourages members of the public to get involved in whale shark research by submitting their photos online. The library currently has over 8000 individually identified whale sharks from over 50 countries around the world. And an innovative new program by ECOCEAN is engaging the next generation of scientists by involving school children in the satellite-tracking of whale sharks, connecting them to real-world scientific research and inspiring them to protect and conserve our precious marine environment and its inhabitants.</p><p>For more information about ECOCEAN or about the Whale Shark Race Around the World, please contact Samantha Reynolds at <a href=\\"mailto:samantha.reynolds1@uq.net.au\\">mailto:samantha.reynolds1@uq.net.au</a> or 0424563472. For more information about ZoaTrack please visit the website (<a href=\\"https://zoatrack.org/\\">https://zoatrack.org/</a>).</p>","excerpt":"<p>It’s National Science Week this week, and there’s lots of things to get involved in, including the Whale Shark Race Around the World. The Race which officially kicked off yesterday, will see schools around the country join scientists in tracking the movements of the world’s biggest fish &#8211; the Whale Shark.ECOCEAN is Australia’s only not-for-profit [&hellip;]</p>\\n","date":"2017-08-15 16:40:07","modified":"2017-08-15 16:43:34","categories":[{"id":2,"slug":"blogs-news","title":"Blogs &amp; news","description":"","parent":0,"post_count":279}],"tags":[],"author":{"id":31,"slug":"hannah-scottcsiro-au","name":"Hannah Scott","first_name":"Hannah","last_name":"Scott","nickname":"Hannah.Scott@csiro.au","url":"","description":""},"comments":[],"attachments":[{"id":38297,"url":"http://www.ala.org.au/wp-content/uploads/2017/08/SReynolds_photographs_shark_copyright_Janine_Marx.jpg","slug":"sreynolds_photographs_shark_copyright_janine_marx","title":"SReynolds_photographs_shark_copyright_Janine_Marx","description":"","caption":"Samantha Reynolds photographing a Whale Shark.  Image credit: Janine Marx. ","parent":38294,"mime_type":"image/jpeg","images":{"full":{"url":"https://www.ala.org.au/wp-content/uploads/2017/08/SReynolds_photographs_shark_copyright_Janine_Marx.jpg","width":3261,"height":2058},"thumbnail":{"url":"https://www.ala.org.au/wp-content/uploads/2017/08/SReynolds_photographs_shark_copyright_Janine_Marx-150x150.jpg","width":150,"height":150},"medium":{"url":"https://www.ala.org.au/wp-content/uploads/2017/08/SReynolds_photographs_shark_copyright_Janine_Marx-300x189.jpg","width":300,"height":189},"medium_large":{"url":"https://www.ala.org.au/wp-content/uploads/2017/08/SReynolds_photographs_shark_copyright_Janine_Marx-768x485.jpg","width":768,"height":485},"large":{"url":"https://www.ala.org.au/wp-content/uploads/2017/08/SReynolds_photographs_shark_copyright_Janine_Marx-1024x646.jpg","width":1024,"height":646}}},{"id":38298,"url":"http://www.ala.org.au/wp-content/uploads/2017/08/Swim3_30.7.15lge.jpg","slug":"olympus-digital-camera-3","title":"OLYMPUS DIGITAL CAMERA","description":"","caption":"The Whale Shark Race Around the World kicked off on 14th August 2017 just in time for National Science Week.  Image credit: ECOCEAN","parent":38294,"mime_type":"image/jpeg","images":{"full":{"url":"https://www.ala.org.au/wp-content/uploads/2017/08/Swim3_30.7.15lge.jpg","width":1894,"height":1421},"thumbnail":{"url":"https://www.ala.org.au/wp-content/uploads/2017/08/Swim3_30.7.15lge-150x150.jpg","width":150,"height":150},"medium":{"url":"https://www.ala.org.au/wp-content/uploads/2017/08/Swim3_30.7.15lge-300x225.jpg","width":300,"height":225},"medium_large":{"url":"https://www.ala.org.au/wp-content/uploads/2017/08/Swim3_30.7.15lge-768x576.jpg","width":768,"height":576},"large":{"url":"https://www.ala.org.au/wp-content/uploads/2017/08/Swim3_30.7.15lge-1024x768.jpg","width":1024,"height":768}}}],"comment_count":0,"comment_status":"closed","custom_fields":{}},{"id":38290,"type":"post","slug":"national-science-week-are-you-up-for-the-challenge","url":"https://www.ala.org.au/blogs-news/national-science-week-are-you-up-for-the-challenge/","status":"publish","title":"National Science Week – are you up for the challenge?","title_plain":"National Science Week – are you up for the challenge?","content":"<p>Commencing tomorrow, National Science Week is celebrating its 20<sup>th</sup> birthday, and it’s your opportunity to help do science! There are numerous ways that users of the ALA can participate in National Science Week activities:</p><ul><li><a href=\\"http://sightings.ala.org.au/\\">Add your sightings</a> of plants or animals directly to the ALA. </li><li>Contribute your sightings to one of the many <a href=\\"http://biocollect.ala.org.au/acsa\\">citizen science projects currently happening</a> in different areas of Australia through our project finder tool. </li><li>Be part of the volunteering team at <a href=\\"http://volunteer.ala.org.au/\\">DigiVol</a>.</li><li>Get involved in the <a href=\\"http://csna.gaiaresources.com.au/wordpress/\\">Australian Citizen Science Association</a>.</li><li>Take the kids along to the new Collections exhibit at the CSIRO Discovery Centre, where you can find out more about CSIRO’s collections including the ALA.</li><li>If you have skills in identifying organisms, why not <a href=\\"http://www.bowerbird.org.au/\\">join BowerBird</a> and help other people identify their sightings.</li><li>Check out our ‘Image a Day’ posts on Facebook.</li><li>Join in Great Australian Biodiversity Challenge brought to you by Questagame in partnership with Australia’s botanic gardens, by taking part in one of the Bushland Nature Walks (<a href=\\"https://www.scienceweek.net.au/bushland-nature-walk-questagame-challenge/\\">https://www.scienceweek.net.au/bushland-nature-walk-questagame-challenge</a>). </li><li>Follow the Whale Shark Race around the world, satellite tracking of the world’s largest fish (<a href=\\"https://zoatrack.org/whalesharkrace\\">https://zoatrack.org/whalesharkrace</a>).</li></ul><p>Citizen science is a very important source of data about biodiversity to the ALA. Data and insights gained through the efforts of citizen scientists can be as valuable as those obtained by scientists working in academia, natural history collections, government agencies and business, and the ALA welcomes more collaborators.</p>","excerpt":"<p>Commencing tomorrow, National Science Week is celebrating its 20th birthday, and it’s your opportunity to help do science! There are numerous ways that users of the ALA can participate in National Science Week activities:Add your sightings of plants or animals directly to the ALA. Contribute your sightings to one of the many citizen science projects currently [&hellip;]</p>\\n","date":"2017-08-11 09:38:34","modified":"2017-08-11 09:38:34","categories":[{"id":2,"slug":"blogs-news","title":"Blogs &amp; news","description":"","parent":0,"post_count":279}],"tags":[],"author":{"id":30,"slug":"heather-walshcsiro-au","name":"Heather Walsh","first_name":"Heather","last_name":"Walsh","nickname":"heather.walsh@csiro.au","url":"","description":""},"comments":[],"attachments":[],"comment_count":0,"comment_status":"closed","custom_fields":{}}]}
                """.stripIndent()

        when:
        def check1 = diffService.hasChangedJsonDiff(json1, json1, query, true)
        then:
        check1 == false

        when:
        def check2 = diffService.hasChangedJsonDiff(json1, json2, query, true)
        then:
        check2 == true
    }

    void "test hasChangedJsonDiff for new records query"() {
        given:
        def query = Query.findByName("New records")
        def json1 = """
                {"pageSize":2,"startIndex":0,"totalRecords":624,"sort":"first_loaded_date","dir":"desc","status":"OK","occurrences":[{"uuid":"77da1a0d-84c0-43a8-8ad9-3aa89e2b2672","occurrenceID":"https://www.flickr.com/photos/126953422@N04/36019316063/","taxonConceptID":"urn:lsid:biodiversity.org.au:afd.taxon:090ae627-3c3f-4883-be29-302b1891cdcd","eventDate":1497657600000,"occurrenceYear":1483228800000,"scientificName":"Ardea (Typhon) sumatrana","vernacularName":"Great-billed Heron","taxonRank":"species","taxonRankID":7000,"country":"Australia","kingdom":"Animalia","phylum":"Chordata","classs":"Aves","order":"Ciconiiformes","family":"Ardeidae","genus":"Ardea","genusGuid":"urn:lsid:biodiversity.org.au:afd.taxon:adf1f806-e3f8-475c-a46c-744ee9a10767","species":"Ardea sumatrana","speciesGuid":"urn:lsid:biodiversity.org.au:afd.taxon:090ae627-3c3f-4883-be29-302b1891cdcd","stateProvince":"Western Australia","decimalLatitude":-15.553177,"decimalLongitude":125.225343,"coordinateUncertaintyInMeters":14,"year":"2017","month":"06","basisOfRecord":"Image","left":57163,"right":57163,"dataProviderUid":"dp29","dataProviderName":"Flickr","dataResourceUid":"dr360","dataResourceName":"Encyclopedia of Life Images - Flickr Group","assertions":["assumedPresentOccurrenceStatus","geodeticDatumAssumedWgs84","habitatMismatch"],"speciesGroups":["Animals","Birds"],"image":"d2f6e943-e147-4a85-b19f-3b94391f67a1","images":["d2f6e943-e147-4a85-b19f-3b94391f67a1"],"geospatialKosher":"false","taxonomicKosher":"true","collector":"Graham Winterflood","collectors":["Winterflood, G. Graham"],"raw_scientificName":"Ardea sumatrana","raw_basisOfRecord":"Image","latLong":"-15.553177,125.225343","point1":"-16,125","point01":"-15.6,125.2","point001":"-15.55,125.23","point0001":"-15.553,125.225","point00001":"-15.5532,125.2253","namesLsid":"Ardea (Typhon) sumatrana|urn:lsid:biodiversity.org.au:afd.taxon:090ae627-3c3f-4883-be29-302b1891cdcd|Great-billed Heron|Animalia|Ardeidae","multimedia":["Image"],"occurrenceDetails":"https://www.flickr.com/photos/126953422@N04/36019316063/","miscIntProperties":{"occurrence_decade_i":2010},"imageUrl":"http://images.ala.org.au/image/proxyImage?imageId=d2f6e943-e147-4a85-b19f-3b94391f67a1","largeImageUrl":"http://images.ala.org.au/image/proxyImageThumbnailLarge?imageId=d2f6e943-e147-4a85-b19f-3b94391f67a1","smallImageUrl":"http://images.ala.org.au/image/proxyImageThumbnail?imageId=d2f6e943-e147-4a85-b19f-3b94391f67a1","thumbnailUrl":"http://images.ala.org.au/image/proxyImageThumbnail?imageId=d2f6e943-e147-4a85-b19f-3b94391f67a1","imageUrls":["http://images.ala.org.au/image/proxyImageThumbnailLarge?imageId=d2f6e943-e147-4a85-b19f-3b94391f67a1"]},{"uuid":"f01368a0-16ff-41b0-bf8d-2ded73fe884c","occurrenceID":"https://www.flickr.com/photos/126953422@N04/36115339414/","taxonConceptID":"urn:lsid:biodiversity.org.au:afd.taxon:7fa1974f-c976-4ec7-9bdf-35b2f962982d","eventDate":1454284800000,"occurrenceYear":1451606400000,"scientificName":"Rhyothemis resplendens","taxonRank":"species","taxonRankID":7000,"country":"Australia","kingdom":"Animalia","phylum":"Arthropoda","classs":"Insecta","order":"Odonata","family":"Libellulidae","genus":"Rhyothemis","genusGuid":"urn:lsid:biodiversity.org.au:afd.taxon:871da67c-2d56-40a1-8ede-59bd5367a327","species":"Rhyothemis resplendens","speciesGuid":"urn:lsid:biodiversity.org.au:afd.taxon:7fa1974f-c976-4ec7-9bdf-35b2f962982d","stateProvince":"Queensland","decimalLatitude":-16.903411,"decimalLongitude":145.749295,"coordinateUncertaintyInMeters":16,"year":"2016","month":"02","basisOfRecord":"Image","left":153155,"right":153155,"lga":"Cairns (R)","dataProviderUid":"dp29","dataProviderName":"Flickr","dataResourceUid":"dr360","dataResourceName":"Encyclopedia of Life Images - Flickr Group","assertions":["firstOfMonth","assumedPresentOccurrenceStatus","geodeticDatumAssumedWgs84"],"speciesGroups":["Animals","Arthropods","Insects"],"image":"f94270dd-3d17-4ead-990d-520a36d6ce39","images":["f94270dd-3d17-4ead-990d-520a36d6ce39"],"geospatialKosher":"true","taxonomicKosher":"true","collector":"Graham Winterflood","collectors":["Winterflood, G. Graham"],"raw_scientificName":"Rhyothemis resplendens","raw_basisOfRecord":"Image","latLong":"-16.903411,145.749295","point1":"-17,146","point01":"-16.9,145.7","point001":"-16.9,145.75","point0001":"-16.903,145.749","point00001":"-16.9034,145.7493","namesLsid":"Rhyothemis resplendens|urn:lsid:biodiversity.org.au:afd.taxon:7fa1974f-c976-4ec7-9bdf-35b2f962982d||Animalia|Libellulidae","multimedia":["Image"],"occurrenceDetails":"https://www.flickr.com/photos/126953422@N04/36115339414/","miscIntProperties":{"occurrence_decade_i":2010},"imageUrl":"http://images.ala.org.au/image/proxyImage?imageId=f94270dd-3d17-4ead-990d-520a36d6ce39","largeImageUrl":"http://images.ala.org.au/image/proxyImageThumbnailLarge?imageId=f94270dd-3d17-4ead-990d-520a36d6ce39","smallImageUrl":"http://images.ala.org.au/image/proxyImageThumbnail?imageId=f94270dd-3d17-4ead-990d-520a36d6ce39","thumbnailUrl":"http://images.ala.org.au/image/proxyImageThumbnail?imageId=f94270dd-3d17-4ead-990d-520a36d6ce39","imageUrls":["http://images.ala.org.au/image/proxyImageThumbnailLarge?imageId=f94270dd-3d17-4ead-990d-520a36d6ce39"]}],"facetResults":[{"fieldName":"basis_of_record","fieldResult":[{"label":"HumanObservation","count":538,"fq":"basis_of_record:\\"HumanObservation\\""},{"label":"Image","count":86,"fq":"basis_of_record:\\"Image\\""}]}],"query":"?q=first_loaded_date%3A%5B2017-09-01T09%3A48%3A00Z+TO+*%5D","urlParameters":"?q=first_loaded_date%3A%5B2017-09-01T09%3A48%3A00Z+TO+*%5D","queryTitle":"Date first indexed:[2017-09-01T09:48:00Z TO *]","activeFacetMap":{}}
                """.stripIndent()
        def json2 = """
                {"pageSize":2,"startIndex":0,"totalRecords":624,"sort":"first_loaded_date","dir":"desc","status":"OK","occurrences":[{"uuid":"afb2d66f-4d05-4561-8327-fdd55de318d1","occurrenceID":"https://www.flickr.com/photos/126953422@N04/35969370594/","taxonConceptID":"urn:lsid:biodiversity.org.au:afd.taxon:8e407974-a2d8-4ee0-a05f-5c956d6cfad8","eventDate":1503446400000,"occurrenceYear":1483228800000,"scientificName":"Charadrius (Charadrius) ruficapillus","vernacularName":"Red-capped Plover","taxonRank":"species","taxonRankID":7000,"country":"Australia","kingdom":"Animalia","phylum":"Chordata","classs":"Aves","order":"Charadriiformes","family":"Charadriidae","genus":"Charadrius","genusGuid":"urn:lsid:biodiversity.org.au:afd.taxon:cce37714-ef08-4d55-8b34-5c34af9194e5","species":"Charadrius ruficapillus","speciesGuid":"urn:lsid:biodiversity.org.au:afd.taxon:8e407974-a2d8-4ee0-a05f-5c956d6cfad8","stateProvince":"Queensland","decimalLatitude":-16.088887,"decimalLongitude":145.466623,"coordinateUncertaintyInMeters":15,"year":"2017","month":"08","basisOfRecord":"Image","left":55737,"right":55737,"lga":"Cairns (R)","dataProviderUid":"dp29","dataProviderName":"Flickr","dataResourceUid":"dr360","dataResourceName":"Encyclopedia of Life Images - Flickr Group","assertions":["assumedPresentOccurrenceStatus","geodeticDatumAssumedWgs84","habitatMismatch"],"speciesGroups":["Animals","Birds"],"image":"adfdd0d7-3f90-410d-90f5-a9fdeeb40957","images":["adfdd0d7-3f90-410d-90f5-a9fdeeb40957"],"geospatialKosher":"false","taxonomicKosher":"true","collector":"Graham Winterflood","collectors":["Winterflood, G. Graham"],"raw_scientificName":"Charadrius ruficapillus","raw_basisOfRecord":"Image","latLong":"-16.088887,145.466623","point1":"-16,145","point01":"-16.1,145.5","point001":"-16.09,145.47","point0001":"-16.089,145.467","point00001":"-16.0889,145.4666","namesLsid":"Charadrius (Charadrius) ruficapillus|urn:lsid:biodiversity.org.au:afd.taxon:8e407974-a2d8-4ee0-a05f-5c956d6cfad8|Red-capped Plover|Animalia|Charadriidae","multimedia":["Image"],"occurrenceDetails":"https://www.flickr.com/photos/126953422@N04/35969370594/","miscIntProperties":{"occurrence_decade_i":2010},"imageUrl":"http://images.ala.org.au/image/proxyImage?imageId=adfdd0d7-3f90-410d-90f5-a9fdeeb40957","largeImageUrl":"http://images.ala.org.au/image/proxyImageThumbnailLarge?imageId=adfdd0d7-3f90-410d-90f5-a9fdeeb40957","smallImageUrl":"http://images.ala.org.au/image/proxyImageThumbnail?imageId=adfdd0d7-3f90-410d-90f5-a9fdeeb40957","thumbnailUrl":"http://images.ala.org.au/image/proxyImageThumbnail?imageId=adfdd0d7-3f90-410d-90f5-a9fdeeb40957","imageUrls":["http://images.ala.org.au/image/proxyImageThumbnailLarge?imageId=adfdd0d7-3f90-410d-90f5-a9fdeeb40957"]},{"uuid":"3d88bf25-ec0c-4768-9157-586c68b60f5c","occurrenceID":"https://www.flickr.com/photos/126953422@N04/36021608784/","taxonConceptID":"urn:lsid:biodiversity.org.au:afd.taxon:b8743788-9d12-4be1-8c96-932ac9e5580b","eventDate":1500249600000,"occurrenceYear":1483228800000,"scientificName":"Petroica (Petroica) goodenovii","vernacularName":"Red-capped Robin","taxonRank":"species","taxonRankID":7000,"country":"Australia","kingdom":"Animalia","phylum":"Chordata","classs":"Aves","order":"Passeriformes","family":"Petroicidae","genus":"Petroica","genusGuid":"urn:lsid:biodiversity.org.au:afd.taxon:c611b1a0-957c-4011-af07-46cccd9136e1","species":"Petroica goodenovii","speciesGuid":"urn:lsid:biodiversity.org.au:afd.taxon:b8743788-9d12-4be1-8c96-932ac9e5580b","stateProvince":"Queensland","decimalLatitude":-25.900614,"decimalLongitude":139.355263,"coordinateUncertaintyInMeters":14,"year":"2017","month":"07","basisOfRecord":"Image","left":53039,"right":53039,"lga":"Diamantina (S)","dataProviderUid":"dp29","dataProviderName":"Flickr","dataResourceUid":"dr360","dataResourceName":"Encyclopedia of Life Images - Flickr Group","assertions":["assumedPresentOccurrenceStatus","geodeticDatumAssumedWgs84"],"speciesGroups":["Animals","Birds"],"image":"4d910eb7-78a7-43ad-9e90-b33569278015","images":["4d910eb7-78a7-43ad-9e90-b33569278015"],"geospatialKosher":"true","taxonomicKosher":"true","collector":"Graham Winterflood","collectors":["Winterflood, G. Graham"],"raw_scientificName":"Petroica goodenovii","raw_basisOfRecord":"Image","latLong":"-25.900614,139.355263","point1":"-26,139","point01":"-25.9,139.4","point001":"-25.9,139.36","point0001":"-25.901,139.355","point00001":"-25.9006,139.3553","namesLsid":"Petroica (Petroica) goodenovii|urn:lsid:biodiversity.org.au:afd.taxon:b8743788-9d12-4be1-8c96-932ac9e5580b|Red-capped Robin|Animalia|Petroicidae","multimedia":["Image"],"occurrenceDetails":"https://www.flickr.com/photos/126953422@N04/36021608784/","miscIntProperties":{"occurrence_decade_i":2010},"imageUrl":"http://images.ala.org.au/image/proxyImage?imageId=4d910eb7-78a7-43ad-9e90-b33569278015","largeImageUrl":"http://images.ala.org.au/image/proxyImageThumbnailLarge?imageId=4d910eb7-78a7-43ad-9e90-b33569278015","smallImageUrl":"http://images.ala.org.au/image/proxyImageThumbnail?imageId=4d910eb7-78a7-43ad-9e90-b33569278015","thumbnailUrl":"http://images.ala.org.au/image/proxyImageThumbnail?imageId=4d910eb7-78a7-43ad-9e90-b33569278015","imageUrls":["http://images.ala.org.au/image/proxyImageThumbnailLarge?imageId=4d910eb7-78a7-43ad-9e90-b33569278015"]}],"facetResults":[{"fieldName":"basis_of_record","fieldResult":[{"label":"HumanObservation","count":538,"fq":"basis_of_record:\\"HumanObservation\\""},{"label":"Image","count":86,"fq":"basis_of_record:\\"Image\\""}]}],"query":"?q=first_loaded_date%3A%5B2017-09-01T09%3A48%3A00Z+TO+*%5D","urlParameters":"?q=first_loaded_date%3A%5B2017-09-01T09%3A48%3A00Z+TO+*%5D","queryTitle":"Date first indexed:[2017-09-01T09:48:00Z TO *]","activeFacetMap":{}}
                """.stripIndent()
        when:
        def check1 = diffService.hasChangedJsonDiff(json1, json1, query, true)
        then:
        check1 == false

        when:
        def check2 = diffService.hasChangedJsonDiff(json1, json2, query, true)
        then:
        check2 == true
    }

    void "test hasChangedJsonDiff for Datasets query"() {
        given:
        def query = Query.findByName("Datasets")
        def json1 = "[{\"name\":\"cxcx\",\"uri\":\"http://collections.ala.org.au/ws/dataResource/dr5053\",\"uid\":\"dr5053\"},{\"name\":\" Warringah Species List\",\"uri\":\"http://collections.ala.org.au/ws/dataResource/dr4047\",\"uid\":\"dr4047\"},{\"name\":\"1 Quantitative\",\"uri\":\"http://collections.ala.org.au/ws/dataResource/dr2615\",\"uid\":\"dr2615\"},{\"name\":\"2 qualitative\",\"uri\":\"http://collections.ala.org.au/ws/dataResource/dr2616\",\"uid\":\"dr2616\"},{\"name\":\"20 Best Euclid characters\",\"uri\":\"http://collections.ala.org.au/ws/dataResource/dr2585\",\"uid\":\"dr2585\"},{\"name\":\"2016 Avifauna of Wallaroo\",\"uri\":\"http://collections.ala.org.au/ws/dataResource/dr6693\",\"uid\":\"dr6693\"},{\"name\":\"2WEL-01\",\"uri\":\"http://collections.ala.org.au/ws/dataResource/dr2182\",\"uid\":\"dr2182\"},{\"name\":\"3 Acacia Qualitative\",\"uri\":\"http://collections.ala.org.au/ws/dataResource/dr2617\",\"uid\":\"dr2617\"},{\"name\":\"3 tree frogs\",\"uri\":\"http://collections.ala.org.au/ws/dataResource/dr6785\",\"uid\":\"dr6785\"}]"
        def json2 = "[{\"name\":\"Warringah Species List\",\"uri\":\"http://collections.ala.org.au/ws/dataResource/dr4047\",\"uid\":\"dr4047\"},{\"name\":\"1 Quantitative\",\"uri\":\"http://collections.ala.org.au/ws/dataResource/dr2615\",\"uid\":\"dr2615\"},{\"name\":\"2 qualitative\",\"uri\":\"http://collections.ala.org.au/ws/dataResource/dr2616\",\"uid\":\"dr2616\"},{\"name\":\"20 Best Euclid characters\",\"uri\":\"http://collections.ala.org.au/ws/dataResource/dr2585\",\"uid\":\"dr2585\"},{\"name\":\"2016 Avifauna of Wallaroo\",\"uri\":\"http://collections.ala.org.au/ws/dataResource/dr6693\",\"uid\":\"dr6693\"},{\"name\":\"2WEL-01\",\"uri\":\"http://collections.ala.org.au/ws/dataResource/dr2182\",\"uid\":\"dr2182\"},{\"name\":\"3 Acacia Qualitative\",\"uri\":\"http://collections.ala.org.au/ws/dataResource/dr2617\",\"uid\":\"dr2617\"},{\"name\":\"3 tree frogs\",\"uri\":\"http://collections.ala.org.au/ws/dataResource/dr6785\",\"uid\":\"dr6785\"},{\"name\":\"3AusMimulus\",\"uri\":\"http://collections.ala.org.au/ws/dataResource/dr2456\",\"uid\":\"dr2456\"},{\"name\":\"4 Quantitative\",\"uri\":\"http://collections.ala.org.au/ws/dataResource/dr2618\",\"uid\":\"dr2618\"}]"

        when:
        def check1 = diffService.hasChangedJsonDiff(json1, json1, query, true)
        then:
        check1 == false

        when:
        def check2 = diffService.hasChangedJsonDiff(json1, json2, query, true)
        then:
        check2 == true
    }

    void "test hasChangedJsonDiff for Spatial layers query"() {
        given:
        def query = Query.findByName("Spatial layers")
        def json1 = "[{\"displayname\":\"NVIS 4.1 Major Vegetation Groups\",\"enabled\":true,\"uid\":\"2125\",\"metadatapath\":\"http://www.environment.gov.au/fed/catalog/search/resource/details.page?uuid=%7Beade4b5f-6a30-46ae-86d8-58ed374ddc72%7D\",\"classification1\":\"Vegetation\",\"classification2\":\"Classification\",\"notes\":\"\",\"source_link\":\"http://www.environment.gov.au/fed/catalog/search/resource/downloadData.page?uuid=%7Beade4b5f-6a30-46ae-86d8-58ed374ddc72%7D\",\"licence_link\":\"http://www.environment.gov.au/fed/catalog/search/resource/details.page?uuid=%7Beade4b5f-6a30-46ae-86d8-58ed374ddc72%7D\",\"licence_notes\":\"Separate State/Territory acknowledgement required on citation\",\"maxlatitude\":-8.13987,\"minlatitude\":-44.31837,\"minlongitude\":109.50436,\"maxlongitude\":157.21622,\"pid\":\"\",\"shape\":true,\"path_orig\":\"shape_diva/nvis41_mvg\",\"environmentalvalueunits\":\"\",\"displaypath\":\"http://spatial.ala.org.au/geoserver/gwc/service/wms?service=WMS&version=1.1.0&request=GetMap&layers=ALA:nvis41_mvg&format=image/png&styles=\",\"domain\":\"Terrestrial\",\"dt_added\":1448542800000,\"environmentalvaluemax\":\"\",\"environmentalvaluemin\":\"\",\"lookuptablepath\":\"\",\"citation_date\":\"11/2012\",\"datalang\":\"\",\"licence_level\":\"2\",\"mddatest\":\"\",\"mdhrlv\":\"\",\"respparty_role\":\"custodian\",\"keywords\":\"dominant, tree, forest, woodland, canopy, understory\",\"path_1km\":\"\",\"scale\":\"\",\"description\":\"Major Vegetation Groups were identified to summarise the type and distribution of Australia's native vegetation. The classification contains different mixes of plant species within the canopy, shrub or ground layers, but are structurally similar and are often dominated by a single genus. In a mapping sense, the groups reflect the dominant vegetation occurring in a map unit where there are a mix of several vegetation types. Subdominant vegetation groups which may also be present in the map unit are not shown. For example, the dominant vegetation in an area may be mapped as dominated by eucalypt open forest, although it contains pockets of rainforest, shrubland and grassland vegetation as subdominants.\",\"source\":\"http://www.environment.gov.au/fed/catalog/search/resource/details.page?uuid=%7Beade4b5f-6a30-46ae-86d8-58ed374ddc72%7D\",\"name\":\"nvis41_mvg\",\"id\":2125,\"type\":\"Contextual\",\"path\":\"/data/ala/data/layers/ready/shape_diva\"},{\"displayname\":\"Occurrence Density\",\"enabled\":true,\"uid\":\"898\",\"metadatapath\":\"http://www.ala.org.au/\",\"classification1\":\"Biodiversity\",\"classification2\":\"\",\"notes\":\"Occurrence Density is derived by applying a moving average to all point occurrences held by the Atlas of Living Australia. If all occurrences are mapped (over terrestrial and marine areas), a moving average is like moving a window with many panes over the area, noting the number of occurrences in each pane and placing the average of all panes at the centre pane. The window is moved to the next sample location and the process repeated. Occurrence density uses a 9 by 9 pane window where each pane is 0.01 degrees latitude/longitude. Each move of the window is 0.01 degrees.\\r\\n\\r\\nScope: World\",\"source_link\":\"\",\"licence_link\":\"\",\"licence_notes\":\"\",\"maxlatitude\":-10.46623,\"minlatitude\":-36.41364,\"minlongitude\":96.79992,\"maxlongitude\":159.23333,\"pid\":\"\",\"grid\":true,\"path_orig\":\"diva/odensity\",\"environmentalvalueunits\":\"frequency\",\"displaypath\":\"http://spatial.ala.org.au/geoserver/gwc/service/wms?service=WMS&version=1.1.0&request=GetMap&layers=ALA:odensity&format=image/png&styles=\",\"domain\":\"Terrestrial, Marine\",\"dt_added\":1439388000000,\"environmentalvaluemax\":\"446649\",\"environmentalvaluemin\":\"0\",\"lookuptablepath\":\"\",\"citation_date\":\"\",\"datalang\":\"\",\"licence_level\":\"0\",\"mddatest\":\"\",\"mdhrlv\":\"\",\"respparty_role\":\"\",\"keywords\":\"average, sample\",\"path_1km\":\"\",\"scale\":\"0.01 degree (~1km)\",\"description\":\"Occurrence Density\",\"source\":\"ALA-SPATIAL\",\"name\":\"odensity\",\"id\":898,\"type\":\"Environmental\",\"path\":\"/data/ala/data/source/occurrence_layers/layer_occurrence_av_1.tif\"},{\"displayname\":\"Species Richness\",\"enabled\":true,\"uid\":\"899\",\"metadatapath\":\"http://www.ala.org.au/\",\"classification1\":\"Biodiversity\",\"classification2\":\"\",\"notes\":\"Species Richness is derived by applying a moving average to all point occurrences held by the Atlas of Living Australia. If all occurrences are mapped (over terrestrial and marine areas), a moving average is like moving a window with many panes over the area, noting the number of differences species in each pane and placing the average of all panes at the centre pane. The window is moved to the next sample location and the process repeated. Species Richness uses a 9 by 9 pane window where each pane is 0.01 degrees latitude/longitude. Each move of the window is 0.01 degrees.\\r\\n\\r\\nScope: World\",\"source_link\":\"\",\"licence_link\":\"\",\"licence_notes\":\"\",\"maxlatitude\":-9.0,\"minlatitude\":-43.8,\"minlongitude\":112.9,\"maxlongitude\":153.64,\"pid\":\"\",\"grid\":true,\"path_orig\":\"diva/srichness\",\"environmentalvalueunits\":\"frequency\",\"displaypath\":\"http://spatial.ala.org.au/geoserver/gwc/service/wms?service=WMS&version=1.1.0&request=GetMap&layers=ALA:srichness&format=image/png&styles=\",\"domain\":\"Terrestrial, Marine\",\"dt_added\":1439301600000,\"environmentalvaluemax\":\"7791\",\"environmentalvaluemin\":\"0\",\"lookuptablepath\":\"\",\"citation_date\":\"\",\"datalang\":\"\",\"licence_level\":\"0\",\"mddatest\":\"\",\"mdhrlv\":\"\",\"respparty_role\":\"\",\"keywords\":\"diversity, occurrence, sample, average\",\"path_1km\":\"\",\"scale\":\"0.01 degree (~1km)\",\"description\":\"Species Richness\",\"source\":\"ALA-SPATIAL\",\"name\":\"srichness\",\"id\":899,\"type\":\"Environmental\",\"path\":\"/data/ala/data/source/occurrence_layers/layer_species_av_1.tif\"}]"
        def json2 = "[{\"displayname\":\"Vegetation types - present\",\"enabled\":true,\"uid\":\"620\",\"metadatapath\":\"http://www.environment.gov.au/erin/nvis/mvg/index.html , http://www.environment.gov.au/erin/nvis/publications/pubs/major-veg-summary.pdf\",\"classification1\":\"Vegetation\",\"classification2\":\"\",\"notes\":\"Primary data with some data gaps filling from Major Vegetation Groups\",\"source_link\":\"http://data.daff.gov.au/anrdl/metadata_files/pa_vast_g9abll0032008_11a.xml\",\"licence_link\":\"http://data.daff.gov.au/anrdl/metadata_files/pa_vast_g9abll0032008_11a.xml\",\"licence_notes\":\"All material in this publication is licensed under a Creative Commons Attribution 3.0 Australia Licence, save for content supplied by third parties, logos and the Commonwealth Coat of Arms. This publication (and any material sourced from it) should be attributed as: Source: ABARES. Users of the data set are asked to acknowledge, in any visual or published material, that it was derived and compiled by ABARES. Users of the data set are asked to make known to ABARES any errors, omissions or suggestions for improvement.\",\"maxlatitude\":-9.22397,\"minlatitude\":-43.67225,\"minlongitude\":112.91646,\"maxlongitude\":153.6377,\"pid\":\"\",\"shape\":true,\"path_orig\":\"shape/present_veg\",\"environmentalvalueunits\":\"class\",\"displaypath\":\"http://spatial.ala.org.au/geoserver/gwc/service/wms?service=WMS&version=1.1.0&request=GetMap&layers=ALA:present_veg&format=image/png&styles=\",\"domain\":\"Terrestrial\",\"dt_added\":1317906000000,\"environmentalvaluemax\":\"99\",\"environmentalvaluemin\":\"0\",\"lookuptablepath\":\"\",\"citation_date\":\"2006\",\"datalang\":\"eng\",\"licence_level\":\"3\",\"mddatest\":\"2009-08\",\"mdhrlv\":\"\",\"respparty_role\":\"distributor\",\"keywords\":\"\",\"path_1km\":\"\",\"scale\":\"\",\"description\":\"Current major vegetation group (class)\",\"source\":\"ERIN\",\"name\":\"present_veg\",\"id\":620,\"type\":\"Contextual\",\"path\":\"/mnt/transfer/MCAS_1k_Datapack/Vegetation/present_veg.tif\"},{\"displayname\":\"NVIS 4.1 Major Vegetation Groups\",\"enabled\":true,\"uid\":\"2125\",\"metadatapath\":\"http://www.environment.gov.au/fed/catalog/search/resource/details.page?uuid=%7Beade4b5f-6a30-46ae-86d8-58ed374ddc72%7D\",\"classification1\":\"Vegetation\",\"classification2\":\"Classification\",\"notes\":\"\",\"source_link\":\"http://www.environment.gov.au/fed/catalog/search/resource/downloadData.page?uuid=%7Beade4b5f-6a30-46ae-86d8-58ed374ddc72%7D\",\"licence_link\":\"http://www.environment.gov.au/fed/catalog/search/resource/details.page?uuid=%7Beade4b5f-6a30-46ae-86d8-58ed374ddc72%7D\",\"licence_notes\":\"Separate State/Territory acknowledgement required on citation\",\"maxlatitude\":-8.13987,\"minlatitude\":-44.31837,\"minlongitude\":109.50436,\"maxlongitude\":157.21622,\"pid\":\"\",\"shape\":true,\"path_orig\":\"shape_diva/nvis41_mvg\",\"environmentalvalueunits\":\"\",\"displaypath\":\"http://spatial.ala.org.au/geoserver/gwc/service/wms?service=WMS&version=1.1.0&request=GetMap&layers=ALA:nvis41_mvg&format=image/png&styles=\",\"domain\":\"Terrestrial\",\"dt_added\":1448542800000,\"environmentalvaluemax\":\"\",\"environmentalvaluemin\":\"\",\"lookuptablepath\":\"\",\"citation_date\":\"11/2012\",\"datalang\":\"\",\"licence_level\":\"2\",\"mddatest\":\"\",\"mdhrlv\":\"\",\"respparty_role\":\"custodian\",\"keywords\":\"dominant, tree, forest, woodland, canopy, understory\",\"path_1km\":\"\",\"scale\":\"\",\"description\":\"Major Vegetation Groups were identified to summarise the type and distribution of Australia's native vegetation. The classification contains different mixes of plant species within the canopy, shrub or ground layers, but are structurally similar and are often dominated by a single genus. In a mapping sense, the groups reflect the dominant vegetation occurring in a map unit where there are a mix of several vegetation types. Subdominant vegetation groups which may also be present in the map unit are not shown. For example, the dominant vegetation in an area may be mapped as dominated by eucalypt open forest, although it contains pockets of rainforest, shrubland and grassland vegetation as subdominants.\",\"source\":\"http://www.environment.gov.au/fed/catalog/search/resource/details.page?uuid=%7Beade4b5f-6a30-46ae-86d8-58ed374ddc72%7D\",\"name\":\"nvis41_mvg\",\"id\":2125,\"type\":\"Contextual\",\"path\":\"/data/ala/data/layers/ready/shape_diva\"},{\"displayname\":\"Occurrence Density\",\"enabled\":true,\"uid\":\"898\",\"metadatapath\":\"http://www.ala.org.au/\",\"classification1\":\"Biodiversity\",\"classification2\":\"\",\"notes\":\"Occurrence Density is derived by applying a moving average to all point occurrences held by the Atlas of Living Australia. If all occurrences are mapped (over terrestrial and marine areas), a moving average is like moving a window with many panes over the area, noting the number of occurrences in each pane and placing the average of all panes at the centre pane. The window is moved to the next sample location and the process repeated. Occurrence density uses a 9 by 9 pane window where each pane is 0.01 degrees latitude/longitude. Each move of the window is 0.01 degrees.\\r\\n\\r\\nScope: World\",\"source_link\":\"\",\"licence_link\":\"\",\"licence_notes\":\"\",\"maxlatitude\":-10.46623,\"minlatitude\":-36.41364,\"minlongitude\":96.79992,\"maxlongitude\":159.23333,\"pid\":\"\",\"grid\":true,\"path_orig\":\"diva/odensity\",\"environmentalvalueunits\":\"frequency\",\"displaypath\":\"http://spatial.ala.org.au/geoserver/gwc/service/wms?service=WMS&version=1.1.0&request=GetMap&layers=ALA:odensity&format=image/png&styles=\",\"domain\":\"Terrestrial, Marine\",\"dt_added\":1439388000000,\"environmentalvaluemax\":\"446649\",\"environmentalvaluemin\":\"0\",\"lookuptablepath\":\"\",\"citation_date\":\"\",\"datalang\":\"\",\"licence_level\":\"0\",\"mddatest\":\"\",\"mdhrlv\":\"\",\"respparty_role\":\"\",\"keywords\":\"average, sample\",\"path_1km\":\"\",\"scale\":\"0.01 degree (~1km)\",\"description\":\"Occurrence Density\",\"source\":\"ALA-SPATIAL\",\"name\":\"odensity\",\"id\":898,\"type\":\"Environmental\",\"path\":\"/data/ala/data/source/occurrence_layers/layer_occurrence_av_1.tif\"},{\"displayname\":\"Species Richness\",\"enabled\":true,\"uid\":\"899\",\"metadatapath\":\"http://www.ala.org.au/\",\"classification1\":\"Biodiversity\",\"classification2\":\"\",\"notes\":\"Species Richness is derived by applying a moving average to all point occurrences held by the Atlas of Living Australia. If all occurrences are mapped (over terrestrial and marine areas), a moving average is like moving a window with many panes over the area, noting the number of differences species in each pane and placing the average of all panes at the centre pane. The window is moved to the next sample location and the process repeated. Species Richness uses a 9 by 9 pane window where each pane is 0.01 degrees latitude/longitude. Each move of the window is 0.01 degrees.\\r\\n\\r\\nScope: World\",\"source_link\":\"\",\"licence_link\":\"\",\"licence_notes\":\"\",\"maxlatitude\":-9.0,\"minlatitude\":-43.8,\"minlongitude\":112.9,\"maxlongitude\":153.64,\"pid\":\"\",\"grid\":true,\"path_orig\":\"diva/srichness\",\"environmentalvalueunits\":\"frequency\",\"displaypath\":\"http://spatial.ala.org.au/geoserver/gwc/service/wms?service=WMS&version=1.1.0&request=GetMap&layers=ALA:srichness&format=image/png&styles=\",\"domain\":\"Terrestrial, Marine\",\"dt_added\":1439301600000,\"environmentalvaluemax\":\"7791\",\"environmentalvaluemin\":\"0\",\"lookuptablepath\":\"\",\"citation_date\":\"\",\"datalang\":\"\",\"licence_level\":\"0\",\"mddatest\":\"\",\"mdhrlv\":\"\",\"respparty_role\":\"\",\"keywords\":\"diversity, occurrence, sample, average\",\"path_1km\":\"\",\"scale\":\"0.01 degree (~1km)\",\"description\":\"Species Richness\",\"source\":\"ALA-SPATIAL\",\"name\":\"srichness\",\"id\":899,\"type\":\"Environmental\",\"path\":\"/data/ala/data/source/occurrence_layers/layer_species_av_1.tif\"}]"

        when:
        def check1 = diffService.hasChangedJsonDiff(json1, json1, query, true)
        then:
        check1 == false

        when:
        def check2 = diffService.hasChangedJsonDiff(json1, json2, query, true)
        then:
        check2 == true
    }
}
